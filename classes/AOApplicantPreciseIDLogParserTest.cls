@IsTest
private class AOApplicantPreciseIDLogParserTest {

    @IsTest
    private static void testHappyPath() {
        String testData = '{"form":{"name":"accountsandfunding","tracking_code":"T9FH3WF","job_reference_code":"PV4DHML"},"applicant":{"person":{"first_name":"Paul","last_name":"Ferguson","birth_date":"1958-01-01","tax_id":"666-37-1340","primary_address":{"line_1":"4400 Central Way","line_2":"Ste 510","city":"Chubbuck","state":"ID","country":"USA","postal_code":"83202"},"identification":{"type":"drivers_license","id_number":"101800775","issuing_authority":"CO","issue_date":"2018-01-01","expire_date":"2028-01-01"},"credit_score":{"score":null,"score_date":null},"home_phone":{"country_code":null,"phone_number":"3081231234","extension":null},"mobile_phone":{"country_code":null,"phone_number":null,"extension":null},"work_phone":{"country_code":null,"phone_number":null,"extension":null},"email":"dmagill@iccu.com"},"persona":"Unknown","membership_eligibility":"I\'m not a permanent resident, but am an employee, employer, student and/or retiree working in Idaho.","system_info":[{"system_name":"GetKBAQuestionsForApplicant","system_display_name":"Experian - KBA Questions","status":"APPROVE","decision":"APPROVE","everything":"{\\"responseHeader\\":{\\"requestType\\":\\"PreciseIdOnly\\",\\"clientReferenceId\\":\\"S3C878420180816112530\\",\\"expRequestId\\":\\"RB000010661823\\",\\"messageTime\\":\\"2018-08-16T11:25:30Z\\",\\"overallResponse\\":{\\"decision\\":\\"REFER\\",\\"decisionText\\":\\"Continue and Investigate\\",\\"decisionReasons\\":[\\"REFER - PreciseID\\"],\\"recommendedNextActions\\":[],\\"spareObjects\\":[]},\\"responseCode\\":\\"R0201\\",\\"responseType\\":\\"INFO\\",\\"responseMessage\\":\\"Workflow Complete.\\",\\"tenantID\\":\\"Y36ZJBSA\\"},\\"clientResponsePayload\\":{\\"orchestrationDecisions\\":[{\\"sequenceId\\":\\"1\\",\\"decisionSource\\":\\"PreciseID\\",\\"decision\\":\\"REFER\\",\\"decisionReasons\\":[\\"REFER - PreciseID\\"],\\"score\\":711,\\"decisionText\\":\\"REFER\\",\\"nextAction\\":\\"Continue\\",\\"appReference\\":\\"33370924\\",\\"decisionTime\\":\\"2018-08-16T17:25:32Z\\"}],\\"decisionElements\\":[{\\"serviceName\\":\\"PreciseId\\",\\"applicantId\\":\\"APPLICANT_1\\",\\"decision\\":\\"R10\\",\\"score\\":711,\\"decisionText\\":\\"Refer\\",\\"appReference\\":\\"33370924\\",\\"rules\\":[{\\"ruleId\\":\\"3401\\",\\"ruleName\\":\\"glbRule01\\"}],\\"otherData\\":{\\"json\\":{\\"fraudSolutions\\":{\\"response\\":{\\"products\\":{\\"preciseIDServer\\":{\\"sessionID\\":\\"UMBB4OTZHIF3OFBA02LMZ2DA.pidd1v-1808161225310210011783248\\",\\"header\\":{\\"reportDate\\":\\"08162018\\",\\"reportTime\\":\\"122531\\",\\"productOption\\":\\"11\\",\\"subcode\\":\\"2851150\\",\\"referenceNumber\\":\\"S3C878420180816112530\\"},\\"messages\\":{\\"message\\":[{\\"number\\":\\"57\\",\\"text\\":\\"015000    0000\\",\\"addrMismatch\\":\\"N\\"}],\\"consumerStatement\\":[]},\\"summary\\":{\\"transactionID\\":\\"33370924\\",\\"initialDecision\\":\\"R10\\",\\"finalDecision\\":\\"R10\\",\\"scores\\":{\\"preciseIDScore\\":\\"711\\",\\"preciseIDScorecard\\":\\"AC OPEN V2\\",\\"validationScore\\":\\"000711\\",\\"validationScorecard\\":\\"AC OPEN VAL V2\\",\\"verificationScore\\":\\"000867\\",\\"verificationScorecard\\":\\"AC OPEN ID THEFT V2\\",\\"complianceDescription\\":\\"No Compliance Code\\",\\"reasons\\":{\\"reason\\":[{\\"value\\":\\"\\",\\"code\\":\\"B205\\"},{\\"value\\":\\"\\",\\"code\\":\\"B223\\"},{\\"value\\":\\"\\",\\"code\\":\\"B108\\"},{\\"value\\":\\"\\",\\"code\\":\\"B405\\"},{\\"value\\":\\"\\",\\"code\\":\\"B405\\"}]},\\"fpdscore\\":\\"000484\\",\\"fpdscorecard\\":\\"AC OPEN FPD V2\\"}},\\"preciseMatch\\":{\\"version\\":\\"02.00\\",\\"responseStatusCode\\":{\\"value\\":\\"\\",\\"code\\":\\"00\\"},\\"preciseMatchTransactionID\\":\\"c4289c27-e85c-431d-9\\",\\"preciseMatchScore\\":\\"756\\",\\"preciseMatchDecision\\":{\\"value\\":\\"\\",\\"code\\":\\" \\"},\\"addresses\\":{\\"address\\":[{\\"summary\\":{\\"verificationResult\\":{\\"value\\":\\"\\",\\"code\\":\\"A1\\"},\\"type\\":{\\"value\\":\\"\\",\\"code\\":\\"P \\"},\\"unitMismatchResult\\":{\\"value\\":\\"\\",\\"code\\":\\"  \\"},\\"highRiskResult\\":{\\"value\\":\\"\\",\\"code\\":\\"N \\"},\\"counts\\":{\\"standardizedAddressReturnCount\\":1,\\"residentialAddressMatchCount\\":1,\\"residentialAddressReturnCount\\":1,\\"highRiskAddressReturnCount\\":0,\\"businessAddressMatchCount\\":0,\\"businessAddressReturnCount\\":0}},\\"detail\\":{\\"standardizedAddressRcd\\":{\\"surname\\":\\"BOLAND\\",\\"firstName\\":\\"MARK\\",\\"address\\":\\"PO BOX 20823\\",\\"city\\":\\"HOT SPRINGS NATIONAL PARK\\",\\"state\\":\\"AR\\",\\"zipCode\\":\\"71903\\"},\\"residentialAddressRcd\\":[{\\"surname\\":\\"BOLAND\\",\\"firstName\\":\\"MARK\\",\\"middle\\":\\"A\\",\\"aliasName\\":[],\\"address\\":\\"PO BOX 20823\\",\\"city\\":\\"HOT SPRINGS NATIONAL PARK\\",\\"state\\":\\"AR\\",\\"zipCode\\":\\"71903\\",\\"zipPlus4\\":\\"0823\\",\\"areaCode\\":\\"423\\",\\"phone\\":\\"6241407\\",\\"monthsAtResidence\\":\\"0012\\",\\"lastUpdatedDate\\":\\"20051115\\"}],\\"highRiskAddressRcd\\":[],\\"highRiskAddressDescription\\":[{\\"highRiskDescription\\":\\"No high risk business at address/phone\\"}],\\"businessAddressRcd\\":[]}}]},\\"phones\\":{\\"phone\\":[{\\"summary\\":{\\"verificationResult\\":{\\"value\\":\\"\\",\\"code\\":\\"IX\\"},\\"classification\\":{\\"value\\":\\"\\",\\"code\\":\\"X\\"},\\"highRiskResult\\":{\\"value\\":\\"\\",\\"code\\":\\"N\\"},\\"counts\\":{\\"residentialPhoneMatchCount\\":0,\\"residentialPhoneReturnCount\\":0,\\"highRiskPhoneReturnCount\\":0,\\"businessPhoneMatchCount\\":0,\\"businessPhoneReturnCount\\":0}},\\"detail\\":{\\"residentialPhoneRcd\\":[],\\"phoneHighRiskRcd\\":[],\\"highRiskPhoneDescription\\":[{\\"highRiskDescription\\":\\"No high risk business at address/phone\\"}],\\"businessPhoneRcd\\":[]}}]},\\"consumerID\\":{\\"summary\\":{\\"verificationResult\\":{\\"value\\":\\"\\",\\"code\\":\\"YA\\"},\\"deceasedResult\\":{\\"value\\":\\"\\",\\"code\\":\\"N\\"},\\"formatResult\\":{\\"value\\":\\"\\",\\"code\\":\\"V\\"},\\"issueResult\\":{\\"value\\":\\"\\",\\"code\\":\\"I\\"},\\"issueState\\":\\"CA\\",\\"issueStartRange\\":\\"1965\\",\\"issueEndRange\\":\\"1977\\",\\"counts\\":{\\"consumerIDReturnCount\\":1}},\\"detail\\":{\\"consumerIDRcd\\":[{\\"surname\\":\\"BOLAND\\",\\"firstName\\":\\"MARK\\",\\"middle\\":\\"A\\",\\"aliasName\\":[],\\"address\\":\\"PO BOX 20823\\",\\"city\\":\\"HOT SPRINGS NATIONAL PARK\\",\\"state\\":\\"AR\\",\\"zipCode\\":\\"71903\\",\\"zipPlus4\\":\\"0823\\",\\"areaCode\\":\\"423\\",\\"phone\\":\\"6241407\\",\\"reportedDate\\":\\"20051115\\",\\"lastUpdatedDate\\":\\"20060728\\"}]}},\\"dateOfBirth\\":{\\"summary\\":{\\"matchResult\\":{\\"value\\":\\"\\",\\"code\\":\\"9\\"},\\"monthOfBirth\\":\\"03\\",\\"dayOfBirth\\":\\"18\\",\\"yearOfBirth\\":\\"1959\\"}},\\"driverLicense\\":{\\"summary\\":{\\"verificationResult\\":{\\"value\\":\\"\\",\\"code\\":\\"YA\\"},\\"formatValidation\\":{\\"value\\":\\"\\",\\"code\\":\\"V\\"}}},\\"changeOfAddresses\\":{\\"changeOfAddress\\":[{\\"summary\\":{\\"verificationResult\\":{\\"value\\":\\"\\",\\"code\\":\\"N \\"},\\"counts\\":{\\"changeOfAddressReturnCount\\":0}}}]},\\"ofac\\":{\\"summary\\":{\\"verificationResult\\":{\\"value\\":\\"\\",\\"code\\":\\"1 \\"},\\"counts\\":{\\"ofacReturnCount\\":0}}},\\"previousAddresses\\":{\\"previousAddress\\":[{\\"summary\\":{\\"counts\\":{\\"previousAddressReturnCount\\":2}},\\"detail\\":{\\"previousAddressRcd\\":[{\\"address\\":\\"RR 2 BOX 222FB\\",\\"city\\":\\"HARRIMAN\\",\\"state\\":\\"TN\\",\\"zipCode\\":\\"37748\\",\\"zipPlus4\\":\\"9802\\",\\"reportedDate\\":\\"20000810\\",\\"lastUpdatedDate\\":\\"20060612\\"},{\\"address\\":\\"1606 MACCLESBY\\",\\"city\\":\\"CHANNELVIEW\\",\\"state\\":\\"TX\\",\\"reportedDate\\":\\"20060606\\",\\"lastUpdatedDate\\":\\"20060606\\"}]}}]},\\"ssnfinder\\":{\\"summary\\":{\\"counts\\":{\\"ssnfinderReturnCount\\":0}}}},\\"kba\\":{\\"general\\":{\\"sessionID\\":\\"UMBB4OTZHIF3OFBA02LMZ2DA.pidd1v-1808161225310210011783248\\",\\"numberOfQuestions\\":4,\\"kbaresultCodeDescription\\":\\"KBA processing successful questions returned\\",\\"kbaresultCode\\":0},\\"questionSet\\":[{\\"questionType\\":3,\\"questionText\\":\\"According to your credit profile, you may have opened an auto loan in or around October 2017. Please select the lender for this account. If you do not have such an auto loan, select \'NONE OF THE ABOVE/DOES NOT APPLY\'.\\",\\"questionSelect\\":{\\"questionChoice\\":[\\"B B AND T\\",\\"CITI AUTO\\",\\"GMAC\\",\\"BMW FINANCIAL SVCS\\",\\"NONE OF THE ABOVE/DOES NOT APPLY\\"]}},{\\"questionType\\":23,\\"questionText\\":\\"Which of the following is a current or previous employer? If there is not a matched employer name, please select \'NONE OF THE ABOVE\'.\\",\\"questionSelect\\":{\\"questionChoice\\":[\\"AVONDALE SCHOOL\\",\\"LANIER WORLDWIDE\\",\\"L AND L ENTERPRISE\\",\\"CUBODO STEAK HOUSE\\",\\"NONE OF THE ABOVE/DOES NOT APPLY\\"]}},{\\"questionType\\":45,\\"questionText\\":\\"Which of the following represents the last four digits of your primary checking account number?\\",\\"questionSelect\\":{\\"questionChoice\\":[\\"5939\\",\\"5948\\",\\"5957\\",\\"5966\\",\\"NONE OF THE ABOVE/DOES NOT APPLY\\"]}},{\\"questionType\\":33,\\"questionText\\":\\"You may have opened a mortgage loan in or around April 2017. Please select the dollar amount range in which your monthly mortgage payment falls. Refer only to the regular monthly payment which includes principal, interest, and escrow (escrow could include taxes and insurance if collected by lender). If you have not had a mortgage payment now or in the past, please select \'NONE OF THE ABOVE/DOES NOT APPLY\'.\\",\\"questionSelect\\":{\\"questionChoice\\":[\\"$1100 - $1399\\",\\"$1400 - $1699\\",\\"$1700 - $1999\\",\\"$2000 - $2299\\",\\"NONE OF THE ABOVE/DOES NOT APPLY\\"]}}],\\"creditQuestionSet\\":[],\\"nonCreditQuestionSet\\":[]},\\"pidxmlversion\\":\\"06.00\\",\\"fcraDetail\\":{\\"fraudShield\\":{\\"indicator\\":[{\\"value\\":\\"N\\",\\"code\\":\\"07\\"},{\\"value\\":\\"N\\",\\"code\\":\\"08\\"},{\\"value\\":\\"N\\",\\"code\\":\\"09\\"},{\\"value\\":\\"N\\",\\"code\\":\\"19\\"},{\\"value\\":\\"N\\",\\"code\\":\\"20\\"},{\\"value\\":\\"N\\",\\"code\\":\\"22\\"},{\\"value\\":\\"N\\",\\"code\\":\\"27\\"}]},\\"adverseActions\\":{\\"adverseAction\\":[{\\"value\\":\\"\\",\\"code\\":\\" \\"},{\\"value\\":\\"\\",\\"code\\":\\" \\"},{\\"value\\":\\"\\",\\"code\\":\\" \\"},{\\"value\\":\\"\\",\\"code\\":\\" \\"}]},\\"fcrarules\\":{\\"fcrarule\\":[{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"}]}},\\"glbDetail\\":{\\"fraudShield\\":{\\"indicator\\":[{\\"value\\":\\"N\\",\\"code\\":\\"01\\"},{\\"value\\":\\"N\\",\\"code\\":\\"02\\"},{\\"value\\":\\"N\\",\\"code\\":\\"03\\"},{\\"value\\":\\"N\\",\\"code\\":\\"04\\"},{\\"value\\":\\"N\\",\\"code\\":\\"05\\"},{\\"value\\":\\"N\\",\\"code\\":\\"06\\"},{\\"value\\":\\"N\\",\\"code\\":\\"10\\"},{\\"value\\":\\"N\\",\\"code\\":\\"11\\"},{\\"value\\":\\"N\\",\\"code\\":\\"13\\"},{\\"value\\":\\"N\\",\\"code\\":\\"14\\"},{\\"value\\":\\"N\\",\\"code\\":\\"15\\"},{\\"value\\":\\"N\\",\\"code\\":\\"16\\"},{\\"value\\":\\"N\\",\\"code\\":\\"17\\"},{\\"value\\":\\"N\\",\\"code\\":\\"18\\"},{\\"value\\":\\"Y\\",\\"code\\":\\"21\\"},{\\"value\\":\\"N\\",\\"code\\":\\"25\\"},{\\"value\\":\\"N\\",\\"code\\":\\"26\\"}]},\\"glbRules\\":{\\"glbRule\\":[{\\"value\\":\\"\\",\\"code\\":\\"3401\\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"},{\\"value\\":\\"\\",\\"code\\":\\"    \\"}]}}}}}}}},\\"decisions\\":[{\\"element\\":\\"messageNumber\\",\\"value\\":\\"57\\",\\"reason\\":\\"015000    0000\\"},{\\"element\\":\\"initialDecision\\",\\"value\\":\\"R10\\"},{\\"element\\":\\"finalDecision\\",\\"value\\":\\"R10\\"},{\\"element\\":\\"kbaResultCode\\",\\"value\\":\\"0\\",\\"reason\\":\\"KBA processing successful questions returned\\"},{\\"element\\":\\"pidScoreReason1\\",\\"value\\":\\"B205\\"},{\\"element\\":\\"pidScoreReason2\\",\\"value\\":\\"B223\\"},{\\"element\\":\\"pidScoreReason3\\",\\"value\\":\\"B108\\"},{\\"element\\":\\"pidScoreReason4\\",\\"value\\":\\"B405\\"},{\\"element\\":\\"pidScoreReason5\\",\\"value\\":\\"B405\\"},{\\"element\\":\\"kbaStatus\\",\\"value\\":\\"Y\\"}],\\"matches\\":[{\\"name\\":\\"pmAddressVerificationResult1\\",\\"value\\":\\"A1\\"},{\\"name\\":\\"pmPhoneVerificationResult1\\",\\"value\\":\\"IX\\"},{\\"name\\":\\"pmConsumerIDVerificationResult\\",\\"value\\":\\"YA\\"},{\\"name\\":\\"pmDateOfBirthMatchResult\\",\\"value\\":\\"9\\"},{\\"name\\":\\"pmDriverLicenseVerificationResult\\",\\"value\\":\\"YA\\"},{\\"name\\":\\"pmChangeOfAddressVerificationResult1\\",\\"value\\":\\"N\\"},{\\"name\\":\\"pmOFACVerificationResult\\",\\"value\\":\\"1\\"},{\\"name\\":\\"fcraFSIndicator07\\",\\"value\\":\\"N\\"},{\\"name\\":\\"fcraFSIndicator08\\",\\"value\\":\\"N\\"},{\\"name\\":\\"fcraFSIndicator09\\",\\"value\\":\\"N\\"},{\\"name\\":\\"fcraFSIndicator19\\",\\"value\\":\\"N\\"},{\\"name\\":\\"fcraFSIndicator20\\",\\"value\\":\\"N\\"},{\\"name\\":\\"fcraFSIndicator22\\",\\"value\\":\\"N\\"},{\\"name\\":\\"fcraFSIndicator27\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator01\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator02\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator03\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator04\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator05\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator06\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator10\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator11\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator13\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator14\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator15\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator16\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator17\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator18\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator21\\",\\"value\\":\\"Y\\"},{\\"name\\":\\"glbFSIndicator25\\",\\"value\\":\\"N\\"},{\\"name\\":\\"glbFSIndicator26\\",\\"value\\":\\"N\\"}],\\"scores\\":[{\\"name\\":\\"preciseIDScore\\",\\"score\\":711,\\"type\\":\\"score\\"},{\\"name\\":\\"validationScore\\",\\"score\\":711,\\"type\\":\\"score\\"},{\\"name\\":\\"verificationScore\\",\\"score\\":867,\\"type\\":\\"score\\"},{\\"name\\":\\"fpdScore\\",\\"score\\":484,\\"type\\":\\"score\\"},{\\"name\\":\\"preciseMatchScore\\",\\"score\\":756,\\"type\\":\\"score\\"}]}]},\\"originalRequestData\\":{\\"application\\":{\\"applicants\\":[{\\"applicantType\\":\\"APPLICANT\\",\\"contactId\\":\\"APPLICANT_1\\",\\"id\\":\\"APPLICANT_1_ID\\",\\"type\\":\\"INDIVIDUAL\\"}]},\\"contacts\\":[{\\"addresses\\":[{\\"addressType\\":\\"CURRENT\\",\\"countryCode\\":\\"USA\\",\\"postTown\\":\\"Hot Sprints National\\",\\"postal\\":\\"71903\\",\\"stateProvinceCode\\":\\"AR\\",\\"street\\":\\"PO Box 20823\\",\\"street2\\":null,\\"timeAtAddress\\":{\\"unit\\":\\"MONTH\\",\\"value\\":36}}],\\"emails\\":[{\\"email\\":\\"sschickedanz@iccu.com\\"}],\\"id\\":\\"APPLICANT_1\\",\\"identityDocuments\\":[{\\"documentNumber\\":\\"59660900\\",\\"documentType\\":\\"DRIVER_LICENSE\\",\\"id\\":\\"APPLICANT_1_DL\\",\\"stateProvinceCode\\":\\"TN\\"},{\\"documentNumber\\":\\"666-88-5379\\",\\"documentType\\":\\"SSN\\",\\"id\\":\\"APPLICANT_1_SSN\\"}],\\"person\\":{\\"names\\":[{\\"firstName\\":\\"Mark\\",\\"id\\":\\"APPLICANT_1_NAME_1\\",\\"surName\\":\\"Boland\\",\\"type\\":\\"CURRENT\\"}],\\"personDetails\\":{\\"dateOfBirth\\":\\"1959-03-18\\"},\\"typeOfPerson\\":\\"APPLICANT\\"},\\"telephones\\":[{\\"number\\":\\"+1 423-624-1407\\"}]}],\\"control\\":[{\\"option\\":\\"PIDXML_VERSION\\",\\"value\\":\\"06.00\\"},{\\"option\\":\\"SUBSCRIBER_PREAMBLE\\",\\"value\\":\\"TRS2\\"},{\\"option\\":\\"SUBSCRIBER_OPERATOR_INITIAL\\",\\"value\\":\\"ID\\"},{\\"option\\":\\"SUBSCRIBER_SUB_CODE\\",\\"value\\":\\"2851150\\"},{\\"option\\":\\"PID_USERNAME\\",\\"value\\":\\"iccu_test\\"},{\\"option\\":\\"PID_PASSWORD\\",\\"value\\":\\"QXZva2FfSUNDVSMx\\"},{\\"option\\":\\"PRODUCT_OPTION\\",\\"value\\":\\"11\\"},{\\"option\\":\\"ACCOUNT_TYPE\\",\\"value\\":\\"\\"},{\\"option\\":\\"DETAIL_REQUEST\\",\\"value\\":\\"D\\"},{\\"option\\":\\"VENDOR\\",\\"value\\":\\"\\"},{\\"option\\":\\"VENDOR_VERSION\\",\\"value\\":\\"\\"},{\\"option\\":\\"BROKER_NUMBER\\",\\"value\\":\\"\\"},{\\"option\\":\\"END_USER\\",\\"value\\":\\"\\"},{\\"option\\":\\"FREEZE_KEY_PIN\\",\\"value\\":\\"\\"}],\\"device\\":{\\"ipAddress\\":\\"65.121.129.2\\"}}}","user_action":"","tracking_number":"HGXQRZ7"}]},"coApplicants":[],"products":[{"product_name":"Free Checking","major_type":"CK","minor_type":"CKBA"},{"product_name":"Share Savings","major_type":"SAV","minor_type":"SREG"}],"fundingInfo":{"from_account_uuid":null,"payment_type":"ACH","is_using_external_processor":true,"opened_accounts":[{"account":{"unique_id":"0af4be6b-be26-4313-80d1-90a5dcc00f55","account_name":null,"account_number":"723216904","balance":100.0,"available_balance":null,"is_active":null,"product":{"product_name":"Free Checking","major_type":"CK","minor_type":"CKBA"}},"from_account":{"unique_id":null,"account_name":null,"account_number":null,"balance":null,"available_balance":null,"is_active":null,"product":{"product_name":null,"major_type":null,"minor_type":null}},"funding_amount":100.0,"funding_source":"ACH"},{"account":{"unique_id":"034f9e3f-4c2b-4fe5-8a6f-eaccad29c890","account_name":null,"account_number":"723216894","balance":25.0,"available_balance":null,"is_active":null,"product":{"product_name":"Share Savings","major_type":"SAV","minor_type":"SREG"}},"from_account":{"unique_id":null,"account_name":null,"account_number":null,"balance":null,"available_balance":null,"is_active":null,"product":{"product_name":null,"major_type":null,"minor_type":null}},"funding_amount":25.0,"funding_source":"ACH"}]},"reports":[],"app_status":"Completed","version":"3","external_crm_id":null}';
        AOApplicationRestRequest request = AOApplicationRestRequest.parse(testData);
        AOApplicationInfo appInfo = new AOApplicationInfo(request);

        Test.startTest();

        AOApplicantPreciseIDLogParser parser = new AOApplicantPreciseIDLogParser();
        try {
            parser.parsePayload(request.applicant.system_info, appInfo);
        } catch(Exception e) {
            System.assert(false, 'Threw an exception: ' + e + ' stack trace: ' + e.getStackTraceString());
        }

        Test.stopTest();

        String systemName = parser.getSystemName();
        AOInteractionResult result = appInfo.systemInteractionResults.get(systemName);

        System.assertNotEquals(null, result);
        System.assertEquals(AOInteractionResult.State.SUCCESS, result.state);
        System.assertNotEquals(null, result.message);
        System.assertEquals('Continue and Investigate; Result Description: No Result Code Provided', result.message);
        System.assertEquals('APPROVE', result.systemDecision);
    }

    @IsTest
    private static void testError() {
        String testData = '{"form":{"name":"accountsandfunding","tracking_code":"T9FH3WF","job_reference_code":"PV4DHML"},"applicant":{"person":{"first_name":"Paul","last_name":"Ferguson","birth_date":"1958-01-01","tax_id":"666-37-1340","primary_address":{"line_1":"4400 Central Way","line_2":"Ste 510","city":"Chubbuck","state":"ID","country":"USA","postal_code":"83202"},"identification":{"type":"drivers_license","id_number":"101800775","issuing_authority":"CO","issue_date":"2018-01-01","expire_date":"2028-01-01"},"credit_score":{"score":null,"score_date":null},"home_phone":{"country_code":null,"phone_number":"3081231234","extension":null},"mobile_phone":{"country_code":null,"phone_number":null,"extension":null},"work_phone":{"country_code":null,"phone_number":null,"extension":null},"email":"dmagill@iccu.com"},"persona":"Unknown","membership_eligibility":"I\'m not a permanent resident, but am an employee, employer, student and/or retiree working in Idaho.","system_info":[{"system_name":"GetKBAQuestionsForApplicant","system_display_name":"Experian - KBA Questions","status":"DECLINE","decision":"DECLINE","everything":"{\\"responseHeader\\":{\\"requestType\\":\\"PreciseIdOnly\\",\\"clientReferenceId\\":\\"PBF3FHV20180821021356\\",\\"expRequestId\\":\\"RB000010814881\\",\\"messageTime\\":\\"2018-08-21T14:13:56Z\\",\\"overallResponse\\":{\\"decision\\":\\"NODECISION\\",\\"decisionText\\":\\"No Decision\\",\\"decisionReasons\\":[\\"Error Or No Decision From FS\\"],\\"recommendedNextActions\\":[],\\"spareObjects\\":[]},\\"responseCode\\":\\"R0201\\",\\"responseType\\":\\"WARNING\\",\\"responseMessage\\":\\"Workflow Complete.\\",\\"tenantID\\":\\"Y36ZJBSA\\"},\\"clientResponsePayload\\":{\\"orchestrationDecisions\\":[{\\"sequenceId\\":\\"1\\",\\"decisionSource\\":\\"PreciseId\\",\\"decision\\":\\"ERROR\\",\\"decisionReasons\\":[\\"PreciseId FS Error\\"],\\"score\\":0,\\"decisionText\\":\\"Continue On FS Error\\",\\"nextAction\\":\\"Continue\\",\\"decisionTime\\":\\"2018-08-21T20:13:57Z\\"}],\\"decisionElements\\":[{\\"serviceName\\":\\"PreciseId\\",\\"warningsErrors\\":[{\\"responseType\\":\\"ERROR\\",\\"responseMessage\\":\\"Mapper call failed. Check the logs for details.\\"}]}]},\\"originalRequestData\\":{\\"application\\":{\\"applicants\\":[{\\"applicantType\\":\\"APPLICANT\\",\\"contactId\\":\\"APPLICANT_1\\",\\"id\\":\\"APPLICANT_1_ID\\",\\"type\\":\\"INDIVIDUAL\\"}]},\\"contacts\\":[{\\"addresses\\":[{\\"addressType\\":\\"CURRENT\\",\\"countryCode\\":\\"USA\\",\\"postTown\\":\\"Martin\\",\\"postal\\":\\"38237\\",\\"stateProvinceCode\\":\\"TX\\",\\"street\\":\\"PO Box 94\\",\\"street2\\":null,\\"timeAtAddress\\":{\\"unit\\":\\"MONTH\\",\\"value\\":79}}],\\"emails\\":[{\\"email\\":\\"thymas@iccu.com\\"}],\\"id\\":\\"APPLICANT_1\\",\\"identityDocuments\\":[{\\"documentNumber\\":\\"DA109928A\\",\\"documentType\\":\\"DRIVER_LICENSE\\",\\"id\\":\\"APPLICANT_1_DL\\",\\"stateProvinceCode\\":\\"ID\\"},{\\"documentNumber\\":\\"666-37-1340\\",\\"documentType\\":\\"SSN\\",\\"id\\":\\"APPLICANT_1_SSN\\"}],\\"person\\":{\\"names\\":[{\\"firstName\\":\\"Paul\\",\\"id\\":\\"APPLICANT_1_NAME_1\\",\\"surName\\":\\"Ferguson\\",\\"type\\":\\"CURRENT\\"}],\\"personDetails\\":{\\"dateOfBirth\\":\\"1958-01-01\\"},\\"typeOfPerson\\":\\"APPLICANT\\"},\\"telephones\\":[{\\"number\\":\\"+1 773-350-4879\\"}]}],\\"control\\":[{\\"option\\":\\"PIDXML_VERSION\\",\\"value\\":\\"06.00\\"},{\\"option\\":\\"SUBSCRIBER_PREAMBLE\\",\\"value\\":\\"TRS2\\"},{\\"option\\":\\"SUBSCRIBER_OPERATOR_INITIAL\\",\\"value\\":\\"ID\\"},{\\"option\\":\\"SUBSCRIBER_SUB_CODE\\",\\"value\\":\\"2851150\\"},{\\"option\\":\\"PID_USERNAME\\",\\"value\\":\\"iccu_test\\"},{\\"option\\":\\"PID_PASSWORD\\",\\"value\\":\\"QXZva2FfSUNDVSMx\\"},{\\"option\\":\\"PRODUCT_OPTION\\",\\"value\\":\\"11\\"},{\\"option\\":\\"ACCOUNT_TYPE\\",\\"value\\":\\"\\"},{\\"option\\":\\"DETAIL_REQUEST\\",\\"value\\":\\"D\\"},{\\"option\\":\\"VENDOR\\",\\"value\\":\\"\\"},{\\"option\\":\\"VENDOR_VERSION\\",\\"value\\":\\"\\"},{\\"option\\":\\"BROKER_NUMBER\\",\\"value\\":\\"\\"},{\\"option\\":\\"END_USER\\",\\"value\\":\\"\\"},{\\"option\\":\\"FREEZE_KEY_PIN\\",\\"value\\":\\"\\"}],\\"device\\":{\\"ipAddress\\":\\"65.121.129.2\\"}}}","user_action":"","tracking_number":"HGXQRZ7"}]},"coApplicants":[],"products":[{"product_name":"Free Checking","major_type":"CK","minor_type":"CKBA"},{"product_name":"Share Savings","major_type":"SAV","minor_type":"SREG"}],"fundingInfo":{"from_account_uuid":null,"payment_type":"ACH","is_using_external_processor":true,"opened_accounts":[{"account":{"unique_id":"0af4be6b-be26-4313-80d1-90a5dcc00f55","account_name":null,"account_number":"723216904","balance":100.0,"available_balance":null,"is_active":null,"product":{"product_name":"Free Checking","major_type":"CK","minor_type":"CKBA"}},"from_account":{"unique_id":null,"account_name":null,"account_number":null,"balance":null,"available_balance":null,"is_active":null,"product":{"product_name":null,"major_type":null,"minor_type":null}},"funding_amount":100.0,"funding_source":"ACH"},{"account":{"unique_id":"034f9e3f-4c2b-4fe5-8a6f-eaccad29c890","account_name":null,"account_number":"723216894","balance":25.0,"available_balance":null,"is_active":null,"product":{"product_name":"Share Savings","major_type":"SAV","minor_type":"SREG"}},"from_account":{"unique_id":null,"account_name":null,"account_number":null,"balance":null,"available_balance":null,"is_active":null,"product":{"product_name":null,"major_type":null,"minor_type":null}},"funding_amount":25.0,"funding_source":"ACH"}]},"reports":[],"app_status":"Completed","version":"3","external_crm_id":null}';
        AOApplicationRestRequest request = AOApplicationRestRequest.parse(testData);
        AOApplicationInfo appInfo = new AOApplicationInfo(request);

        Test.startTest();

        AOApplicantPreciseIDLogParser parser = new AOApplicantPreciseIDLogParser();
        try {
            parser.parsePayload(request.applicant.system_info, appInfo);
        } catch(Exception e) {
            System.assert(false, 'Threw an exception: ' + e + ' stack trace: ' + e.getStackTraceString());
        }

        Test.stopTest();

        String systemName = parser.getSystemName();
        AOInteractionResult result = appInfo.systemInteractionResults.get(systemName);

        System.assertNotEquals(null, result.message);
        System.assertEquals('Mapper call failed. Check the logs for details. | ', result.message);
        System.assertEquals('DECLINE', result.systemDecision);
    }

}